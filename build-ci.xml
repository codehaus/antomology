<project name="antomology-ci" default="build" basedir="." xmlns:artifact="antlib:org.apache.maven.artifact.ant">

	<!-- type definition for ant-maven tasks -->
	<typedef resource="org/apache/maven/artifact/ant/antlib.xml" uri="urn:maven-artifact-ant">
		<classpath>
			<pathelement location="tools/maven/maven-artifact-ant-2.0.4-dep.jar" />
		</classpath>
	</typedef>

	<!-- import pom.xml to use within build.xml -->
	<artifact:pom id="maven.project" file="pom.xml" />

	<!-- define deploy repository -->
	<artifact:remoteRepository id="deploy.repository" url="https://dav.codehaus.org/snapshots.dist/antomology" />

	<property name="file.jar" location="build/dist/${maven.project.artifactId}-${maven.project.version}.jar" />

	<target name="build">
		<ant antfile="build-main.xml" />
		<antcall target="deploy" />
	</target>

	<target name="deploy">

		<!-- Upload ${file.jar} to the remote repository -->
		<artifact:deploy file="${file.jar}">
			<remoteRepository refid="deploy.repository" />
			<pom refid="maven.project" />
		</artifact:deploy>

	</target>

</project>